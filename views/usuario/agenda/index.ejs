 <div class="d-flex justify-content-center align-items-center mb-4" style="gap: 10px;">
    <!-- Campo cidade -->
    <input type="search"
          id="pesquisaCidade"
          placeholder="Pesquisar por cidade"
          class="form-control pesquisa-custom"
          style="max-width: 250px;">


    <!-- Campo data -->
    <input type="date"
          id="pesquisaData"
          class="form-control pesquisa-custom"
          style="max-width: 200px;">
  </div>
  <% viagens.forEach(function(viagem) { %>


  <div
    class="card shadow-sm mt-2"
    style="
      width: 100%;
      max-width: 700px;
      border-radius: 10px;
      background-color: #d1e3fd;
    "
  >
    <!-- Cabeçalho -->
    <div
      class="card-header d-flex justify-content-between align-items-center"
      style="
        background-color: #a7c9f9;
        border-top-left-radius: 10px;
        border-top-right-radius: 10px;
      "
    >
      <span class="fw-bold" style="color: #062352; font-size: 16px">
        <%= viagem.cidadeconsul.descricao %>
      </span>
       
      <span
        class="fw-bold"
        style="color: #062352; font-size: 15px"
        data-date="<%= viagem.data_viagem %>"
      >
        <%= viagem.data_viagem.split('-').reverse().join('/') %>
      </span>
    </div>
    <!-- Corpo -->
    <div class="card-body">
      <!-- Linha principal com botão Ver mais -->
      <div class="d-flex justify-content-between align-items-center">
        <div class="flex-grow-1">
          <img
            src="/assets/pessoa-azul.png"
            alt="Ícone de Usuário"
            class="mb-1"
            style="width: 20px; height: 20px;""
          />
          <%= viagem.ocupacao %>/<%= viagem.veiculo.lugares_dispo %> Lugares Ocupados
        </div>
        <% const participa = viagem.participantes.some(p => p.usuarioID === codUsuario); %>
        <% const lotada = viagem.ocupacao >= viagem.veiculo.lugares_dispo; %>
        <% const jaSolicitou = viagensSolicitadasIDs.includes(viagem.cod); %>


        <% if (participa) { %>
          <a href="/usuario/inicio/index" class="botao">Participando</a>
        <% } else if (lotada) { %>
          <a href="#" class="botao-desabilitado disabled">Participar</a>
        <% } else if (jaSolicitou) { %>
          <a href="#" class="botao-desabilitado disabled">Participar</a>
        <% } else { %>
          <a href="/usuario/agenda/formulario-participar/<%= viagem.cod %>" class="botao">Participar</a>
        <% } %>
      </div>
    </div>
  </div>
  <% }) %>
</div>


<script>
  const inputCidade = document.getElementById("pesquisaCidade");
  const inputData = document.getElementById("pesquisaData");
  const cards = Array.from(document.querySelectorAll(".card"));


  function filtrar() {
    const termoCidade = inputCidade.value.trim().toLowerCase();
    const termoData = inputData.value; // formato yyyy-mm-dd do input[type="date"]


    cards.forEach((card) => {
      const cidadeElemento = card.querySelector(
        ".card-header span:first-child"
      );
      const dataElemento = card.querySelector(".card-header span:last-child");


      const cidade = cidadeElemento
        ? cidadeElemento.textContent.toLowerCase()
        : "";
      const data = dataElemento ? dataElemento.getAttribute("data-date") : "";
      // converte de dd/mm/yyyy -> yyyy-mm-dd para comparar


      let exibir = true;


      // Filtrar por cidade
      if (termoCidade && !cidade.includes(termoCidade)) {
        exibir = false;
      }


      // Filtrar por data
      if (termoData && data !== termoData) {
        exibir = false;
      }


      card.style.display = exibir ? "block" : "none";
    });
  }

  inputCidade.addEventListener("input", filtrar);
  inputData.addEventListener("change", filtrar);
</script>