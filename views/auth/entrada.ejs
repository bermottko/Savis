<div class="d-flex justify-content-center align-items-center" style="min-height: 100vh;">
    <div class="card shadow rounded-4 p-5" style="width: 100%; max-width: 400px; background-color: #fff;">
      <form action="/auth/verificarUsuario" method="POST">
        <div class="text-center mb-4">
          <img src="/assets/logo.png" alt="Logo" style="width: 50px; height: 70px;">
          <h5 class="mt-2 logo-nome-cadastro">Bem-vindo(a) ao Savis!</h5>
        </div>

        <div class="mb-3">
          <div>
            <input type="radio" id="paciente" name="tipo" value="paciente"  style="transform: scale(0.85); margin-right: 4px;" checked onclick="toggleCampos()" />
            <label for="paciente" style="font-size: 14px;">Paciente</label>
            &nbsp;&nbsp;
            <input type="radio" id="funcionario" name="tipo" value="funcionario"  style="transform: scale(0.85); margin-right: 4px;" onclick="toggleCampos()" />
            <label for="funcionario" style="font-size: 14px;">Funcionário</label>
          </div>
        </div>

        <!-- Campo CPF -->
        <div class="mb-3 mt-4" id="campo-cpf">
          <label for="cpf" class="form-label">CPF</label>
          <input type="text" id="cpf" name="cpf" class="form-control" placeholder="Digite seu CPF"/>
        </div>

        <!-- Campo Matrícula -->
        <div class="mb-3 mt-4 d-none" id="campo-matricula">
          <label for="matricula" class="form-label">Matrícula</label>
          <input type="text" id="matricula" name="matricula" class="form-control" placeholder="Digite sua matrícula"/>
        </div>

        <div class="mb-3">
          <label for="senha" class="form-label">Senha</label>
          <input type="password" id="senha" name="senha" required class="form-control" placeholder="Digite sua senha" />
        </div>

        <div class="d-flex justify-content-between">
            <a href="#" onclick="window.history.back(); return false;" class="botao-cadastro">Voltar</a>
            <button type="submit" class="botao-cadastro">Entrar</button>
        </div>

        <div class="texto-criar-conta">
          <a>Ainda não tem uma conta Savis?</a>
          <a href="/auth/cadastro" class="criar-conta">Criar conta!</a>
        </div>


      </form>
    </div>
</div>

<script>
  function toggleCampos() {
    const pacienteSelecionado = document.getElementById('paciente').checked;

    document.getElementById('campo-cpf').classList.toggle('d-none', !pacienteSelecionado);
    document.getElementById('campo-matricula').classList.toggle('d-none', pacienteSelecionado);

    document.getElementById('cpf').value = '';
    document.getElementById('matricula').value = '';
  }

  function mascaraCPF(cpfInput) {
    let v = cpfInput.value.replace(/\D/g, '');

    if (v.length > 11) v = v.slice(0, 11);

    v = v.replace(/(\d{3})(\d)/, "$1.$2");
    v = v.replace(/(\d{3})(\d)/, "$1.$2");
    v = v.replace(/(\d{3})(\d{1,2})$/, "$1-$2");

    cpfInput.value = v;
  }

  function mascaraMatricula(matriculaInput) {
    let v = matriculaInput.value.replace(/\D/g, '');
    if (v.length > 4) {
      v = v.slice(0, 4);
    }
    matriculaInput.value = v;
  }

  window.onload = () => {
    toggleCampos();

    const form = document.querySelector('form[action="/auth/verificarUsuario"]');
    const cpfInput = document.getElementById('cpf');
    const matriculaInput = document.getElementById('matricula');

    cpfInput.addEventListener('input', () => {
      mascaraCPF(cpfInput);
    });

    matriculaInput.addEventListener('input', () => {
      mascaraMatricula(matriculaInput);
    });

    form.addEventListener('submit', () => {
      cpfInput.value = cpfInput.value.replace(/[.\-]/g, '');
    });
  };
</script>
