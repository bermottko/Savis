<div class="d-flex justify-content-center align-items-start pt-5 pb-5" style="min-height: 100vh;"> 
  <div class="card shadow rounded-4 p-5 mb-5" style="width: 100%; max-width: 600px; background-color: #fff;">
    <form action="/auth/cadastro-motorista/etapa1/processar" method="POST" enctype="multipart/form-data">
      <div class="text-center mb-4">
        <img src="/assets/logo.png" alt="Logo" style="width: 50px; height: 70px;">
        <h5 class="mt-2 logo-nome-cadastro">Cadastro do Motorista</h5>

        <label for="foto_perfil">
          <img id="preview_foto" src="<%= preenchido?.foto_perfil ? '/uploads/' + preenchido.foto_perfil : '/assets/default-profile.jpg' %>" 
            alt="Foto de perfil" class="rounded-circle mt-3 mb-2"
            style="width: 90px; height: 90px; object-fit: cover; cursor: pointer; border: 2px solid #ccc;" />
        </label>
        <input type="file" id="foto_perfil" name="foto_perfil" accept="image/*" class="d-none" onchange="previewImagem(event)">
      </div>

      <div class="mb-3">
        <label for="nome" class="form-label">Nome</label>
        <input type="text" id="nome" name="nome" maxlength="40" required class="form-control"
          placeholder="Digite o nome completo" value="<%= preenchido?.nome || '' %>" />
      </div>

      <div class="mb-3">
      <label for="data_nasc" class="form-label">Data de Nascimento</label>
      <input type="date" id="data_nasc" name="data_nasc" required 
            class="form-control <% if (erroData_nasc) { %>is-invalid<% } %>"
            value="<%= preenchido?.data_nasc || '' %>" />
      </div>
      <% if (erroData_nasc) { %>
        <div class="invalid-feedback"><%= erroData_nasc %></div>
      <% } %>


      <div class="mb-3">
        <label for="CPF" class="form-label">CPF</label>
        <input type="text" id="CPF" name="CPF" maxlength="14" required
          class="form-control <% if (erroCPF) { %>is-invalid<% } %>"
          placeholder="Digite o CPF" value="<%= preenchido?.CPF || '' %>" />
        <% if (erroCPF) { %><div class="invalid-feedback"><%= erroCPF %></div><% } %>
      </div>

      <div class="mb-3">
        <label for="genero" class="form-label">Gênero</label>
        <select id="genero" name="genero" required class="form-select">
          <option value="" disabled <%= !preenchido?.genero ? 'selected' : '' %>>Não selecionado</option>
          <option value="1" <%= preenchido?.genero == '1' ? 'selected' : '' %>>Masculino</option>
          <option value="2" <%= preenchido?.genero == '2' ? 'selected' : '' %>>Feminino</option>
          <option value="3" <%= preenchido?.genero == '3' ? 'selected' : '' %>>Não-binário</option>
          <option value="4" <%= preenchido?.genero == '4' ? 'selected' : '' %>>Outro</option>
        </select>
      </div>

         <div class="d-flex justify-content-between">
        <a href="/admin/motoristas/index" class="botao-cadastro">Voltar</a>
        <button type="submit" class="botao-cadastro">Próximo</button>
    </div>
    </form>
  </div>
</div>

<script>
  function previewImagem(event) {
    const input = event.target;
    const img = document.getElementById('preview_foto');
    if (input.files && input.files[0]) {
      const reader = new FileReader();
      reader.onload = e => img.src = e.target.result;
      reader.readAsDataURL(input.files[0]);
    }
  }

  const cpfInput = document.getElementById('CPF');

  cpfInput.addEventListener('input', function () {
    let valor = this.value.replace(/\D/g, ''); 

    if (valor.length > 11) valor = valor.slice(0, 11); 

    valor = valor.replace(/(\d{3})(\d)/, '$1.$2');
    valor = valor.replace(/(\d{3})(\d)/, '$1.$2');
    valor = valor.replace(/(\d{3})(\d{1,2})$/, '$1-$2');

    this.value = valor;
  });

   const nomeInput = document.getElementById('nome');

  nomeInput.addEventListener('input', function() {
    this.value = this.value.replace(/[^A-Za-zÀ-ÿ\s]/g, '');
  });
</script>
